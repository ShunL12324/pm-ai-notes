# 5.1 MCP 详解

Model Context Protocol - Anthropic 提出的开放协议，用于连接 AI 模型与外部工具/数据源。

## 核心概念

### 什么是 MCP
- **全称**：Model Context Protocol
- **提出者**：Anthropic（2024年11月）
- **定位**：AI 模型与外部世界的"USB 接口"
- **目标**：标准化 LLM 与工具/数据的连接方式

### 解决的问题
- 每个 AI 应用都要单独对接各种工具
- 缺乏统一标准，重复开发
- 工具能力难以跨平台复用

## 架构设计

### Client-Server 模式

```
Host (AI 应用)
    ↓
MCP Client
    ↓
MCP Server → 外部服务（数据库/API/文件系统）
```

### 三大原语 (Primitives)

| 原语 | 控制方 | 用途 | 示例 |
|------|--------|------|------|
| **Tools** | 模型决定调用 | 执行操作 | 搜索、计算、API调用 |
| **Resources** | 应用控制 | 提供上下文 | 文件内容、数据库记录 |
| **Prompts** | 用户触发 | 预设模板 | 代码审查模板 |

### 传输层

- **stdio**：本地进程通信，延迟低
- **HTTP + SSE**：远程服务，支持分布式

## 核心优势

### 跨平台支持
- Claude Desktop、Cursor、Windsurf 等都支持
- 一次开发，多处复用

### 可组合性
- 多个 MCP Server 可以组合使用
- 能力可以灵活搭配

### 标准化接口
- 统一的协议规范
- 降低集成成本

## 典型应用场景

1. **数据库访问**：让 AI 直接查询数据库
2. **文件系统**：读写本地文件
3. **第三方 API**：对接 Slack、GitHub、Notion 等
4. **浏览器控制**：自动化网页操作

## MCP Server 示例

常见的 MCP Server：
- `@modelcontextprotocol/server-filesystem`：文件系统访问
- `@modelcontextprotocol/server-github`：GitHub 操作
- `@modelcontextprotocol/server-slack`：Slack 消息
- 社区开发的各种 Server...

## 配置方式

在 `claude_desktop_config.json` 或 `.mcp.json` 中配置：

```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["-y", "@anthropic/mcp-server-filesystem", "/path/to/dir"]
    }
  }
}
```
